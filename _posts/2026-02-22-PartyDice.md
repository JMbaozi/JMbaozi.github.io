---
layout: post
title: 'æˆ‘çš„ç¬¬ä¸€æ¬¾é…’å±€ç¥å™¨Appâ€œæ‘‡äº†ä¹ˆâ€'
subtitle: 'PartyDice'
date: 2026-02-22 21:20:00 +0800
categories: tech
author: yucol
tags: [å®‰å“, éª°å­, æ¸¸æˆ, ç‹¬ç«‹å¼€å‘]
---


# ğŸš€ æˆ‘çš„ç¬¬ä¸€æ¬¾é…’å±€ç¥å™¨Appâ€œæ‘‡äº†ä¹ˆâ€è¯ç”Ÿè®°ï¼

> æºä»£ç ã€å®‰è£…åŒ…åŠæ•ˆæœå›¾åœ¨æ–‡ç« ç»“å°¾å¤„ã€‚

ä¸€ç›´æƒ³åšä¸€ä¸ªæ—¢å¥½ç©åˆå®ç”¨çš„ä¸œè¥¿ã€‚ç»ˆäºï¼Œåœ¨AIçš„å¸®åŠ©ä¸‹ï¼Œæˆ‘çš„ç¬¬ä¸€æ¬¾ Android ç‹¬ç«‹åº”ç”¨â€”â€”**â€œæ‘‡äº†ä¹ˆâ€**ï¼Œæ­£å¼è¯ç”Ÿå•¦ï¼

è¿™æ˜¯ä¸€æ¬¾ä¸“ä¸ºé…’å±€ã€èšä¼šæ‰“é€ çš„æ‘‡éª°å­å°å·¥å…·ã€‚è™½ç„¶å¸‚é¢ä¸Šæœ‰å¾ˆå¤šç±»ä¼¼çš„å°ç¨‹åºï¼Œä½†ä½œä¸ºä¸€ä¸ªå¼ºè¿«ç—‡+ä½“éªŒæ§ï¼Œå†³å®šäº²è‡ªæ“åˆ€ï¼Œç»™å®ƒæ³¨å…¥çœŸæ­£çš„â€œçµé­‚â€ã€‚

### ğŸ² ä¸ºä»€ä¹ˆå«â€œæ‘‡äº†ä¹ˆâ€ï¼Ÿ

åœ¨é…’æ¡Œä¸Šï¼Œæœ€å¸¸å¬åˆ°çš„ä¸€å¥è¯å¯èƒ½å°±æ˜¯â€œè¯¥ä½ äº†ï¼Œæ‘‡äº†ä¹ˆï¼Ÿâ€ã€‚è¿™ä¸ªåå­—æ—¢æ˜¯å¯¹æœ‹å‹çš„å‚¬ä¿ƒï¼Œä¹Ÿæ˜¯è¿™æ¬¾ App æ ¸å¿ƒäº¤äº’çš„ä½“ç°â€”â€”åˆ«ç‚¹å±å¹•äº†ï¼Œç›´æ¥æ‹¿èµ·æ‰‹æœºæ‘‡å§ï¼

### âœ¨ æ ¸å¿ƒäº®ç‚¹ï¼šæŠŠç»†èŠ‚æ­»ç£•åˆ°åº•

åœ¨ä½“éªŒä¸Šä¸»è¦æœ‰ä»¥ä¸‹äº®ç‚¹ï¼š

* **å‘Šåˆ«åäººç±»UIï¼Œå•æ‰‹æŒæ§å…¨å±€ï¼š**
æŠ›å¼ƒäº†æ—©æœŸç‰ˆæœ¬ä¸­éœ€è¦å‘¼å‡ºè½¯é”®ç›˜æ¥è¾“å…¥éª°å­æ•°é‡çš„ç¹çè®¾è®¡ã€‚åˆ©ç”¨çº¿æ€§å¸ƒå±€ï¼ˆLinearLayoutï¼‰çš„æƒé‡å±æ€§ï¼Œå°†æ ¸å¿ƒè§†è§‰åŒºï¼ˆéª°å­å±•ç¤ºï¼‰å›ºå®šåœ¨ä¸­ä¸Šæ–¹ï¼Œè€Œåœ¨åº•éƒ¨æ‰‹æŒ‡å‡ºæ²¡çš„æœ€èˆ’é€‚åŒºåŸŸï¼ŒåŠ å…¥äº†ä¸æ»‘çš„ `-` å’Œ `+` æŒ‰é’®ã€‚1åˆ°15ä¸ªéª°å­ï¼Œå•æ‰‹ä¸€ç§’åˆ‡æ¢ã€‚
* **æ³¨å…¥çµé­‚çš„â€œç‰©ç†å¤–æŒ‚â€ï¼ˆæ‘‡ä¸€æ‘‡ï¼‰ï¼š**
é…’å±€æ¸¸æˆï¼Œæ€ä¹ˆèƒ½åªç”¨æ‰‹æŒ‡ç‚¹æŒ‰é’®å‘¢ï¼Ÿè°ƒç”¨äº† Android çš„åº•å±‚ç¡¬ä»¶â€”â€”**åŠ é€Ÿåº¦ä¼ æ„Ÿå™¨ (Accelerometer)**ã€‚é€šè¿‡è®¡ç®— Xã€Yã€Z ä¸‰ä¸ªç»´åº¦çš„ç»¼åˆé‡åŠ›åŠ é€Ÿåº¦ï¼Œåªè¦ä½ åƒæ¡ç€çœŸå®éª°ç›…ä¸€æ ·ç”¨åŠ›ç”©åŠ¨æ‰‹æœºï¼Œä»£ç å°±ä¼šè‡ªåŠ¨æ•æ‰ä½ çš„åŠ¨ä½œå¹¶è§¦å‘æ·éª°å­ï¼
* **æ²‰æµ¸å¼çš„å£°æ„Ÿä¸è§¦è§‰åé¦ˆï¼š**
ä¸ºäº†æ¨¡æ‹ŸçœŸå®çš„ç‰©ç†åé¦ˆï¼ŒåŠ å…¥äº†åŒé‡æ„Ÿå®˜åˆºæ¿€ï¼š
  1. **å¬è§‰**ï¼šæ¥å…¥ `MediaPlayer`ï¼Œæ‘‡æ™ƒæ—¶ä¼´éšæ¸…è„†çš„â€œå“—å•¦å“—å•¦â€éª°å­ç¢°æ’å£°ã€‚
  2. **è§¦è§‰**ï¼šè°ƒç”¨ `Vibrator` éœ‡åŠ¨é©¬è¾¾ã€‚åœ¨éª°å­æ»šåŠ¨çš„ 1 ç§’å†…ï¼Œé…åˆåŠ¨ç”»å‘å‡ºæå…¶é«˜é¢‘çš„è½»å¾®éœ‡åŠ¨ï¼Œåœä½çš„ç¬é—´æ¥ä¸€æ¬¡é‡éœ‡ã€‚é—­ä¸Šçœ¼ç›ï¼Œä½ æ‰‹é‡Œæ¡ç€çš„ä»¿ä½›å°±æ˜¯ä¸ªçœŸéª°ç›…ï¼
* **å®‰å…¨çº¯å‡€æ— å¹¿å‘Šï¼š**
ä»£ç å®Œå…¨å¼€æºï¼Œæ²¡æœ‰ä»»ä½•è”ç½‘å’Œæ”¶é›†éšç§ä¿¡æ¯çš„è¡Œä¸ºï¼›ç•Œé¢å¹²å‡€æ•´æ´ï¼Œæ²¡æœ‰ä»»ä½•å¹¿å‘ŠåŠå¹²æ‰°ä¿¡æ¯ï¼



---

### ğŸ’» æ ¸å¿ƒä»£ç  (Show Me The Code)

è¿™é‡Œåˆ†äº«ä¸€ä¸‹â€œæ‘‡äº†ä¹ˆâ€æœ€æ ¸å¿ƒçš„ä¸¤ä¸ªé€»è¾‘å®ç°ï¼š

#### 1. å¦‚ä½•è®©æ‰‹æœºå¬æ‡‚â€œæ‘‡æ™ƒâ€ï¼Ÿ(ä¼ æ„Ÿå™¨é€»è¾‘)

è¿™é‡Œç”¨åˆ°äº†åˆä¸­çš„ç‰©ç†å’Œæ•°å­¦çŸ¥è¯† ã€‚æ‰‹æœºçš„åŠ é€Ÿåº¦ä¼ æ„Ÿå™¨ä¼šå®æ—¶è¿”å› Xã€Yã€Z ä¸‰ä¸ªè½´çš„å—åŠ›ã€‚ä»¬ç®—å‡ºå®ƒä»¬é™¤ä»¥åœ°çƒé‡åŠ›åŠ é€Ÿåº¦åçš„ G åŠ›ï¼Œç„¶ååˆ©ç”¨å‹¾è‚¡å®šç†  ç®—å‡ºç»¼åˆå—åŠ›ï¼š

```kotlin
// ä¼ æ„Ÿå™¨æ£€æµ‹åˆ°æ‰‹æœºè¿åŠ¨æ—¶è‡ªåŠ¨è°ƒç”¨
override fun onSensorChanged(event: SensorEvent?) {
    if (event != null && !isRolling) {
        val x = event.values[0]
        val y = event.values[1]
        val z = event.values[2]

        // è®¡ç®—åŠ é€Ÿåº¦ï¼Œé™¤ä»¥åœ°çƒé‡åŠ›åŠ é€Ÿåº¦å¾—å‡º G åŠ›
        val gX = x / SensorManager.GRAVITY_EARTH
        val gY = y / SensorManager.GRAVITY_EARTH
        val gZ = z / SensorManager.GRAVITY_EARTH

        // å‹¾è‚¡å®šç†è®¡ç®—ç»¼åˆå—åŠ›å¤§å°
        val gForce = sqrt((gX * gX + gY * gY + gZ * gZ).toDouble()).toFloat()

        // é˜ˆå€¼è®¾å®šä¸º 2.7ï¼šå¤§çº¦æ˜¯ç”¨åŠ›ç”©ä¸€ä¸‹æ‰‹æœºçš„åŠ›åº¦
        if (gForce > 2.7f) {
            val now = System.currentTimeMillis()
            // è®¾ç½® 1 ç§’çš„å†·å´é˜²æŠ–æ—¶é—´
            if (now - lastShakeTime > 1000) {
                lastShakeTime = now
                // æ¨¡æ‹Ÿç”¨æˆ·ç‚¹å‡»äº†æ‘‡éª°å­æŒ‰é’®
                findViewById<Button>(R.id.btnRoll).performClick()
            }
        }
    }
}

```

#### 2. å¦‚ä½•å®ç°é€¼çœŸçš„â€œéª°å­ç¿»æ»šâ€ä¸è§¦è§‰åé¦ˆï¼Ÿ

ä¸ºäº†ä¸è®©ç»“æœæ˜¾å¾—å¤ªçªå…€ï¼Œåˆ©ç”¨å®‰å“è‡ªå¸¦çš„ `CountDownTimer` å†™äº†ä¸€ä¸ª 1 ç§’é’Ÿçš„åŠ¨ç”»å¾ªç¯ã€‚åœ¨è¿™ 1 ç§’å†…ï¼Œä¸ä»…ç–¯ç‹‚åˆ‡æ¢å›¾ç‰‡ã€éšæœºå€¾æ–œè§’åº¦ï¼Œè¿˜åŒæ­¥è°ƒç”¨äº†éœ‡åŠ¨é©¬è¾¾ï¼š

```kotlin
// å¼€å§‹æ‘‡éª°å­åŠ¨ç”»ï¼ˆæŒç»­1000æ¯«ç§’ï¼Œæ¯100æ¯«ç§’åˆ·æ–°ä¸€æ¬¡ï¼‰
object : CountDownTimer(1000, 100) {
    override fun onTick(millisUntilFinished: Long) {
        for (view in diceViews) {
            // éšæœºåˆ‡å›¾å¹¶èµ‹äºˆ -30 åˆ° 30 åº¦çš„éšæœºå€¾æ–œè§’
            view.setImageResource(diceImages[Random.nextInt(6)])
            view.rotation = Random.nextInt(-30, 30).toFloat()
        }
        // æ‘‡æ™ƒè¿‡ç¨‹ä¸­ï¼šè§¦å‘ 20 æ¯«ç§’çš„æè½»å¾®éœ‡åŠ¨ï¼ˆæ¨¡æ‹Ÿéª°å­æ’å‡»æ¯å£ï¼‰
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
            vibrator.vibrate(VibrationEffect.createOneShot(20, VibrationEffect.DEFAULT_AMPLITUDE))
        } else {
            vibrator.vibrate(20)
        }
    }

    override fun onFinish() {
        for (view in diceViews) {
            // å®šæ ¼æœ€ç»ˆç‚¹æ•°ï¼Œå¹¶å°†è§’åº¦æ‘†æ­£
            view.setImageResource(diceImages[Random.nextInt(6)])
            view.rotation = 0f 
        }
        // æ‘‡æ™ƒç»“æŸï¼šè§¦å‘ 100 æ¯«ç§’çš„é‡éœ‡ï¼ˆæ¨¡æ‹Ÿè½æ¡Œå®šéŸ³ï¼‰
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
            vibrator.vibrate(VibrationEffect.createOneShot(100, VibrationEffect.DEFAULT_AMPLITUDE))
        } else {
            vibrator.vibrate(100)
        }
        isRolling = false 
    }
}.start()

```

### ğŸ’¡ å†™åœ¨æœ€å

å¦‚æœä½ ä¹Ÿæƒ³ä½“éªŒä¸€ä¸‹è¿™æ¬¾å°å·¥å…·ï¼Œæˆ–è€…å¯¹æºç æ„Ÿå…´è¶£ï¼Œæ¬¢è¿è®¨è®ºä¸äº¤æµï¼

* é¡¹ç›®åœ°å€ï¼š[https://github.com/JMbaozi/PartyDice](https://github.com/JMbaozi/PartyDice)
* å®‰è£…åŒ…åœ°å€ï¼š[æ‘‡äº†ä¹ˆ v1.0](https://github.com/JMbaozi/PartyDice/releases/tag/v1.0)


![home.jpg](https://youke.xn--y7xa690gmna.cn/s1/2026/02/22/699b03b332e82.webp)